<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>カラオケ点数記録</title>
    <style>
        .record-form {
            margin: 1rem 0;
            display: grid;
            gap: 10px;
            max-width: 500px;
        }
        .record-list {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .record-list th, .record-list td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        .search-box {
            margin: 1rem 0;
        }
        .rating-info {
            margin: 1rem 0;
            font-size: 0.9em;
            color: #666;
        }
    </style>
</head>
<body>
    <h1>カラオケの点数記録アプリ</h1>

    <div class="rating-info">
        ※ 評価基準: 1(低) ～ 5(高)
    </div>

    <!-- 検索ボックス -->
    <div class="search-box">
        <input type="text" id="searchInput" placeholder="検索...">
    </div>

    <!-- 並び替えオプション -->
    <div class="sort-options">
        <select id="sortSelect">
            <option value="date-desc">日付（新しい順）</option>
            <option value="date-asc">日付（古い順）</option>
            <option value="score-desc">点数（高い順）</option>
            <option value="score-asc">点数（低い順）</option>
        </select>
    </div>

    <!-- 記録追加フォーム -->
    <form id="recordForm" class="record-form">
        <input type="date" id="dateInput" required>
        <input type="text" id="songInput" placeholder="曲名" required>
        <input type="number" id="scoreInput" placeholder="点数" required min="0" max="100">
        <input type="number" id="pitchInput" placeholder="音程 (1-40)" min="1" max="40">
        <input type="number" id="longToneInput" placeholder="ロングトーン (1-10)" min="1" max="10">
        <input type="number" id="stabilityInput" placeholder="安定性 (1-30)" min="1" max="30">
        <input type="number" id="techniqueInput" placeholder="テクニック (1-5)" min="1" max="5">
        <input type="number" id="modulationInput" placeholder="抑揚 (1-15)" min="1" max="15">
        <textarea id="commentInput" placeholder="コメント"></textarea>
        <button type="submit">追加</button>
    </form>

    <!-- 記録一覧 -->
    <table id="recordList" class="record-list">
        <thead>
            <tr>
                <th>日付</th>
                <th>曲名</th>
                <th>点数</th>
                <th>音程</th>
                <th>ロングトーン</th>
                <th>安定性</th>
                <th>テクニック</th>
                <th>抑揚</th>
                <th>コメント</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <script>
        let records = [];

        // 記録を追加
        function addRecord(record) {
            records.push(record);
            saveRecords();
            displayRecords();
        }

        // 記録を削除
        function deleteRecord(index) {
            if (confirm('この記録を削除してもよろしいですか？')) {
                records.splice(index, 1);
                saveRecords();
                displayRecords();
            }
        }

        // 記録を保存（ローカルストレージ）
        function saveRecords() {
            localStorage.setItem('karaokeRecords', JSON.stringify(records));
        }

        // 記録を読み込み
        function loadRecords() {
            const saved = localStorage.getItem('karaokeRecords');
            records = saved ? JSON.parse(saved) : [];
            displayRecords();
        }

        // 記録を表示
        function displayRecords() {
            const tbody = document.querySelector('#recordList tbody');
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const sortValue = document.getElementById('sortSelect').value;

            // 検索とソートを適用
            let filteredRecords = records.filter(record => 
                record.song.toLowerCase().includes(searchTerm) ||
                record.comment.toLowerCase().includes(searchTerm)
            );

            // ソート
            filteredRecords.sort((a, b) => {
                switch(sortValue) {
                    case 'date-desc': return new Date(b.date) - new Date(a.date);
                    case 'date-asc': return new Date(a.date) - new Date(b.date);
                    case 'score-desc': return b.score - a.score;
                    case 'score-asc': return a.score - b.score;
                    default: return 0;
                }
            });

            tbody.innerHTML = filteredRecords.map((record, index) => `
                <tr>
                    <td>${record.date}</td>
                    <td>${record.song}</td>
                    <td>${record.score}</td>
                    <td>${record.pitch}</td>
                    <td>${record.longTone}</td>
                    <td>${record.stability}</td>
                    <td>${record.technique}</td>
                    <td>${record.modulation}</td>
                    <td>${record.comment}</td>
                    <td><button onclick="deleteRecord(${index})">削除</button></td>
                </tr>
            `).join('');
        }

        // イベントリスナーの設定
        document.addEventListener('DOMContentLoaded', () => {
            loadRecords();

            document.getElementById('recordForm').addEventListener('submit', e => {
                e.preventDefault();
                const newRecord = {
                    date: document.getElementById('dateInput').value,
                    song: document.getElementById('songInput').value,
                    score: Number(document.getElementById('scoreInput').value),
                    pitch: Number(document.getElementById('pitchInput').value),
                    longTone: Number(document.getElementById('longToneInput').value),
                    stability: Number(document.getElementById('stabilityInput').value),
                    technique: Number(document.getElementById('techniqueInput').value),
                    modulation: Number(document.getElementById('modulationInput').value),
                    comment: document.getElementById('commentInput').value
                };
                addRecord(newRecord);
                e.target.reset();
            });

            document.getElementById('searchInput').addEventListener('input', displayRecords);
            document.getElementById('sortSelect').addEventListener('change', displayRecords);
        });
    </script>
</body>
</html>